<mat-card class="container">
	<mat-card-header>
		<mat-card-title>Google Multi Translator</mat-card-title>
		<mat-card-subtitle>Cloud Translation API</mat-card-subtitle>
	</mat-card-header>

	<mat-card-content>
		<form [formGroup]="formGroup">
			<mat-form-field
				class="w-85"
				appearance="fill"
				*ngIf="!dialogData?.googleApiKey"
			>
				<mat-label>Google API key</mat-label>
				<input
					id="apiKey"
					matInput
					formControlName="apiKey"
					placeholder="Google API key"
				/>
				<mat-icon
					matSuffix
					class="cloud-credentials"
					(click)="onCloudCredentialsHelpClick($event)"
					[matTooltip]="CLOUD_CRED_TOOLTIP_MSG"
					matTooltipPosition="below"
				>
					help_outline
				</mat-icon>
				<mat-error *ngIf="apiKey.invalid"
					>Required to fetch translations!</mat-error
				>
			</mat-form-field>

			<mat-form-field
				[ngClass]="{ 'full-width': true, 'pt-10': !dialogData?.googleApiKey }"
				appearance="fill"
			>
				<mat-label>Insert text</mat-label>
				<textarea
					id="transText"
					matInput
					class="textarea"
					formControlName="translationText"
					placeholder="Text to translate"
				></textarea>
				<mat-error *ngIf="translationText.invalid"
					>Insert text to translate!</mat-error
				>
			</mat-form-field>

			<mat-form-field appearance="fill" class="full-width pt-10">
				<mat-label>To</mat-label>
				<mat-select
					id="dropdown"
					formControlName="targetLangs"
					ngDefaultControl
					multiple
				>
					<ng-container *ngIf="onlyPopularLangs.value">
						<mat-option
							*ngFor="
								let popularLang of POPULAR_LANGS | keyvalue : originalOrder
							"
							[value]="popularLang.key"
							>{{ popularLang.value }}</mat-option
						>
					</ng-container>

					<ng-container *ngIf="!onlyPopularLangs.value">
						<mat-option
							*ngFor="let lang of ALL_LANGS | keyvalue : originalOrder"
							[value]="lang.key"
							>{{ lang.value }}</mat-option
						>
					</ng-container>
				</mat-select>
				<mat-error *ngIf="targetLangs.invalid"
					>Choose at least one target language!</mat-error
				>
			</mat-form-field>

			<mat-slide-toggle
				formControlName="onlyPopularLangs"
				(change)="onPopularLangsChange()"
				>Only popular languages</mat-slide-toggle
			>
		</form>
	</mat-card-content>

	<mat-card-actions align="end" class="actions">
		<button
			id="reset"
			mat-raised-button
			(click)="onReset()"
			matTooltip="Clear input and selected languages"
		>
			Reset
		</button>

		<button
			id="search"
			mat-raised-button
			color="primary"
			(click)="onSearch()"
			[disabled]="!formGroup.valid"
			matTooltip="Fetch translations"
		>
			Translate
		</button>
	</mat-card-actions>

	<lib-google-translation-results
		*ngIf="translations$ | async as translations"
		[translations]="translations"
	></lib-google-translation-results>
</mat-card>
